<?php
/**
 * Single Template: Event（イベント・セミナー詳細）
 */
get_header();

// カスタムフィールド取得
$event_date     = get_post_meta( get_the_ID(), 'event_date', true );
$event_time     = get_post_meta( get_the_ID(), 'event_time', true );
$event_venue    = get_post_meta( get_the_ID(), 'event_venue', true );
$event_capacity = get_post_meta( get_the_ID(), 'event_capacity', true );
$event_fee      = get_post_meta( get_the_ID(), 'event_fee', true );
?>

<main class="single single-event">
  <div class="single-container">

    <?php
    if ( have_posts() ) :
      while ( have_posts() ) :
        the_post();
    ?>

    <article <?php post_class(); ?>>

      <header class="single-header">
        <div class="single-meta">
          <span class="single-label single-label--event">イベント</span>
          <?php if ( $event_date ) : ?>
            <span class="single-event-date">開催日: <?php echo esc_html( $event_date ); ?></span>
          <?php endif; ?>
        </div>
        <h1 class="single-title"><?php the_title(); ?></h1>
      </header>

      <?php if ( has_post_thumbnail() ) : ?>
        <div class="single-thumbnail">
          <?php the_post_thumbnail('large'); ?>
        </div>
      <?php endif; ?>

      <!-- イベント情報 -->
      <?php if ( $event_date || $event_time || $event_venue || $event_capacity || $event_fee ) : ?>
      <div class="single-event-info">
        <h3 class="single-event-info-title">イベント概要</h3>
        <dl class="single-event-info-list">
          <?php if ( $event_date ) : ?>
            <div class="single-event-info-item">
              <dt>開催日</dt>
              <dd><?php echo esc_html( $event_date ); ?></dd>
            </div>
          <?php endif; ?>
          <?php if ( $event_time ) : ?>
            <div class="single-event-info-item">
              <dt>時間</dt>
              <dd><?php echo esc_html( $event_time ); ?></dd>
            </div>
          <?php endif; ?>
          <?php if ( $event_venue ) : ?>
            <div class="single-event-info-item">
              <dt>会場</dt>
              <dd><?php echo esc_html( $event_venue ); ?></dd>
            </div>
          <?php endif; ?>
          <?php if ( $event_capacity ) : ?>
            <div class="single-event-info-item">
              <dt>定員</dt>
              <dd><?php echo esc_html( $event_capacity ); ?></dd>
            </div>
          <?php endif; ?>
          <?php if ( $event_fee ) : ?>
            <div class="single-event-info-item">
              <dt>参加費</dt>
              <dd><?php echo esc_html( $event_fee ); ?></dd>
            </div>
          <?php endif; ?>
        </dl>
      </div>
      <?php endif; ?>

      <div class="single-content">
        <?php the_content(); ?>
      </div>

      <!-- イベント申込CTA -->
      <div class="single-cta single-cta--event">
        <div class="single-cta-inner">
          <h3 class="single-cta-title">このイベントに参加する</h3>
          <p class="single-cta-text">下記フォームよりお申し込みください。</p>
          <a href="/resource/general/" class="btn btn--primary">
            イベントに申し込む
          </a>
        </div>
      </div>

    </article>

    <nav class="single-nav">
      <div class="single-nav-prev">
        <?php previous_post_link('%link', '&laquo; 前のイベント'); ?>
      </div>
      <div class="single-nav-back">
        <a href="<?php echo get_post_type_archive_link('event'); ?>">イベント一覧へ戻る</a>
      </div>
      <div class="single-nav-next">
        <?php next_post_link('%link', '次のイベント &raquo;'); ?>
      </div>
    </nav>

    <?php
      endwhile;
    endif;
    ?>

  </div>
</main>

<?php get_footer(); ?>
